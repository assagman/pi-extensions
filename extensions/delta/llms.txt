# Delta — Persistent Memory Extension (v4)

SQLite-backed persistent memory for Pi coding agent. Single unified `memories`
table with FTS5 full-text search. Everything is `content + tags[]` — no separate
KV, episodic, or notes tables. Tag-based classification with importance levels.

## Architecture

Unified CRUD: `remember`, `search`, `forget`, `update`, `getById`. FTS5 indexes
content, tags, and context for full-text search. High/critical importance memories
auto-loaded into system prompt. Git commits auto-captured. Repo-scoped DB at
`~/.local/share/pi-ext-delta/<repo-id>/delta.db`. Injects `<delta_memory>` block
with critical knowledge + memory map every turn.

## Files

- [README](docs/README.md): User documentation, tools, schema, examples, prune
- [ARCHITECTURE](docs/ARCHITECTURE.md): Module structure, data flow, DB schema, migration
- [AGENTS](AGENTS.md): Agent instructions, API reference
- [SKILL](skill/SKILL.md): Agent skill doc — awareness categories, retrieval patterns

## Key Modules

- `src/db.ts`: Schema, migration v3→v4, CRUD, FTS5 search, prompt building (895 lines)
- `src/index.ts`: Extension factory, events, auto-capture, prompt injection (208 lines)
- `src/tools.ts`: Tool definitions (Phase 2 rewrite pending)
- `src/prune/`: Prune module — analyzer, detector, TUI dashboard
